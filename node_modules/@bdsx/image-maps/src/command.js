"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const bdsx_1 = require("bdsx");
const index_1 = require("./index");
const index_2 = require("../index");
const util_1 = require("./util");
const player_1 = require("bdsx/bds/player");
const command_1 = require("bdsx/bds/command");
const nativetype_1 = require("bdsx/nativetype");
const fs = require("fs");
bdsx_1.command.register("map", 'Map command').overload((p, origin, output) => {
    const actor = origin.getEntity();
    if (!(actor instanceof player_1.Player)) {
        return;
    }
    if (actor.getPermissionLevel() != player_1.PlayerPermission.OPERATOR) {
        util_1.sendMessage(actor, `${util_1.TextFormat.RED}You need operator status to run this command!`);
        return;
    }
    const item = actor.getMainhandSlot();
    if (item.getId() !== 418) {
        util_1.sendMessage(actor, `${util_1.TextFormat.RED}You must be holding a map in your hand!`);
        return;
    }
    if (p.param1 == "url") {
        if (p.param2 == undefined) {
            util_1.sendMessage(actor, `${util_1.TextFormat.GREEN}URL not specified`);
            return;
        }
        // @ts-ignore
        index_2.MapApi.setMapImage(item, p.param2.text);
        util_1.sendMessage(actor, `${util_1.TextFormat.GREEN}Setting map image from URL...`);
        return;
    }
    const file = index_1.IMAGE_PATH + "/" + p.param1;
    if (!fs.existsSync(file)) {
        util_1.sendMessage(actor, `${util_1.TextFormat.RED}Could not find specified file`);
        return;
    }
    index_2.MapApi.setMapImage(item, file);
    util_1.sendMessage(actor, `${util_1.TextFormat.GREEN}Setting map image...`);
}, { param1: nativetype_1.CxxString, param2: [command_1.CommandRawText, true] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbWFuZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNvbW1hbmQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwrQkFBK0I7QUFDL0IsbUNBQXFDO0FBQ3JDLG9DQUFrQztBQUNsQyxpQ0FBaUQ7QUFDakQsNENBQTJEO0FBQzNELDhDQUFrRDtBQUNsRCxnREFBNEM7QUFFNUMsTUFBTSxFQUFFLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBRXpCLGNBQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLGFBQWEsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEVBQUU7SUFDbEUsTUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ2pDLElBQUcsQ0FBQyxDQUFDLEtBQUssWUFBWSxlQUFNLENBQUMsRUFBRTtRQUMzQixPQUFPO0tBQ1Y7SUFDRCxJQUFHLEtBQUssQ0FBQyxrQkFBa0IsRUFBRSxJQUFJLHlCQUFnQixDQUFDLFFBQVEsRUFBRTtRQUN4RCxrQkFBVyxDQUFDLEtBQUssRUFBRSxHQUFHLGlCQUFVLENBQUMsR0FBRywrQ0FBK0MsQ0FBQyxDQUFDO1FBQ3JGLE9BQU87S0FDVjtJQUNELE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUNyQyxJQUFHLElBQUksQ0FBQyxLQUFLLEVBQUUsS0FBSyxHQUFHLEVBQUU7UUFDckIsa0JBQVcsQ0FBQyxLQUFLLEVBQUUsR0FBRyxpQkFBVSxDQUFDLEdBQUcseUNBQXlDLENBQUMsQ0FBQztRQUMvRSxPQUFPO0tBQ1Y7SUFDRCxJQUFHLENBQUMsQ0FBQyxNQUFNLElBQUksS0FBSyxFQUFFO1FBQ2xCLElBQUksQ0FBQyxDQUFDLE1BQU0sSUFBSSxTQUFTLEVBQUU7WUFDdkIsa0JBQVcsQ0FBQyxLQUFLLEVBQUUsR0FBRyxpQkFBVSxDQUFDLEtBQUssbUJBQW1CLENBQUMsQ0FBQztZQUMzRCxPQUFPO1NBQ1Y7UUFDRCxhQUFhO1FBQ2IsY0FBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4QyxrQkFBVyxDQUFDLEtBQUssRUFBRSxHQUFHLGlCQUFVLENBQUMsS0FBSywrQkFBK0IsQ0FBQyxDQUFDO1FBQ3ZFLE9BQU87S0FDVjtJQUNELE1BQU0sSUFBSSxHQUFHLGtCQUFVLEdBQUcsR0FBRyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFDekMsSUFBRyxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDckIsa0JBQVcsQ0FBQyxLQUFLLEVBQUUsR0FBRyxpQkFBVSxDQUFDLEdBQUcsK0JBQStCLENBQUMsQ0FBQztRQUNyRSxPQUFPO0tBQ1Y7SUFDRCxjQUFNLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUMvQixrQkFBVyxDQUFDLEtBQUssRUFBRSxHQUFHLGlCQUFVLENBQUMsS0FBSyxzQkFBc0IsQ0FBQyxDQUFDO0FBRWxFLENBQUMsRUFBRSxFQUFFLE1BQU0sRUFBRSxzQkFBUyxFQUFFLE1BQU0sRUFBRSxDQUFDLHdCQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUMsQ0FBQyxDQUFDIn0=